{% extends "base.html" %}
{% block content %}

<div class="card">
    <h1>Welcome to GLOBALLY</h1>
    <p class="welcome-message">Share your thoughts!</p>
    <div style="text-align: center;">
        <a href="{{ url_for('posts.new_posts') }}" class="create-post-btn">Create New Post</a>
    </div>
</div>

<h2 class="section-header">All Posts</h2>


{% for post in posts.items %}
<div class="post-card">
    <div class="post-header">
        <img src="{{ url_for('static', filename='pics/' + (post.author.image_file or 'default.jpg')) }}" alt="{{ post.author.username }}'s profile picture">
        <div>
            <a href="{{ url_for('users.user_posts', username=post.author.username) }}" class="post-author-link"><p class="post-author">{{ post.author.username }}</p></a>
            <h6>{{ post.date_posted.strftime('%d %b %Y') }}</h6>
        </div>
    </div>
    
    <h2>{{ post.title }}</h2>
    <div class="post-content">
        <p>{{ post.content }}</p>
    </div>
    
    {% if current_user == post.author %}
    <div class="post-actions">
        <a href="{{ url_for('posts.update_post', post_id=post.id) }}">Update</a>
        <form action="{{ url_for('posts.delete_post', post_id=post.id) }}" method="post" style="margin: 0; padding: 0; box-shadow: none;">
            <button type="submit"> Delete</button>
        </form>
    </div>
    {% endif %}
</div>
{% endfor %}

<div class="pagination">
    {% for page_num in posts.iter_pages(left_edge=2,right_edge=2,right_current=1,left_current=1) %}
        {% if page_num %}
            {% if page_num == posts.page %}
                <span class="current-page">{{ page_num }}</span>
            {% else %}
                <a href="{{ url_for('main.home', page=page_num) }}">{{ page_num }}</a>
            {% endif %}
        {% else %}
            <span class="ellipsis">â€¦</span>
        {% endif %}
    {% endfor %}
        
</div>
{% endblock %}
